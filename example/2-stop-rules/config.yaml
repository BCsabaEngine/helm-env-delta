source: './source'
destination: './destination'

transforms:
  '**/*.yaml':
    content:
      - find: '-source'
        replace: '-dest'

# Stop rules demonstrating all types
stopRules:
  'app-version.yaml':
    # Block major version upgrades (v1.x â†’ v2.x)
    - type: 'semverMajorUpgrade'
      path: 'image.tag'

    # Block version downgrades
    - type: 'semverDowngrade'
      path: 'chart.version'

    # Enforce strict version format (major.minor.patch only, no pre-release)
    - type: 'versionFormat'
      path: 'app.releaseVersion'
      vPrefix: 'forbidden'

  'scaling.yaml':
    # Enforce replica count limits
    - type: 'numeric'
      path: 'spec.replicas'
      min: 2
      max: 10

  'environment.yaml':
    # Reject v0.x versions (pre-release)
    - type: 'regex'
      path: 'version'
      regex: '^v0\.'

  'helm-chart.yaml':
    # Helm charts: Version must NOT have 'v' prefix (1.2.3 format)
    # Helm follows strict semver without prefix
    - type: 'versionFormat'
      path: 'spec.chart.chartVersion'
      vPrefix: 'forbidden'

  'docker-tag.yaml':
    # Docker tags: Version MUST have 'v' prefix (v1.2.3 format)
    # Common convention for container image tags
    - type: 'versionFormat'
      path: 'spec.template.spec.containers.0.imageTag'
      vPrefix: 'required'

  'hybrid-system.yaml':
    # Flexible: Both 1.2.3 and v1.2.3 are acceptable
    # Legacy systems that support mixed version formats
    - type: 'versionFormat'
      path: 'spec.service.apiVersion'
      vPrefix: 'allowed'
